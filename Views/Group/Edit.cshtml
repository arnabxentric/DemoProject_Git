@model XenERP.Models.Group
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Title = "Xpert | Product Group";
}
@{
    
    int slno = 0;    
    
}
@*<link href="../../css/jquery.treeview.css" rel="stylesheet" type="text/css" />*@

<script src="../../Scripts/jquery.jstree.js" type="text/javascript"></script>
<!-- DATA TABES SCRIPT -->
<script type="text/javascript">
    $(function () {


        $('#example1').dataTable({

            "bPaginate": true,
            "bLengthChange": true,
            "bFilter": true,
            "bSort": true,
            "bInfo": true,
            "bAutoWidth": true
        });
    });
        </script>
<script type="text/javascript">
    //jQuery.noConflict();
    $(document).ready(function () {
        var ptype = '@(ViewBag.IsParent)';

        if (ptype == '') {
            $("#divcode").css("display", "none");
            $("#divname").css("display", "none");
            $("#divpcode").css("display", "none");
            $("#divpname").css("display", "none");
            $("#btnsubmit").css("display", "none");
            $("#btncancel").css("display", "none");

        }
        else if (ptype == 'Parent') {

            $("#parentcode").css("display", "none");
            $("#Code").css("float", "left");
            $("#Code").css("width", "100%");
            $("#parentname").css("display", "none");
            $("#Name").css("float", "left");
            $("#Name").css("width", "100%");
            $("#gcode").text("Group Code");
            $("#gcode").text("Group Name");
            $("#divpcode").css("display", "none");
            $("#divpname").css("display", "none");
            $("#divcode").css("display", "block");
            $("#divname").css("display", "block");
            $("#gcode").text("Group Code");
            $("#gname").text("Group Name");
            $("#ParentGroupId").val(0);
            $("#btnsubmit").css("display", "block");
            $("#btncancel").css("display", "block");
        }
        else if (ptype == 'Child') {
            $("#parentcode").css("display", "block");
            $("#Code").css("float", "left");
            $("#Code").css("width", "32%");
            $("#parentname").css("display", "block");
            $("#Name").css("float", "left");
            $("#Name").css("width", "32%");
            $("#parentcode").val('@(ViewBag.ParentCode)');
            $("#parentname").val('@(ViewBag.ParentName)');

            $("#gcode").text("Sub Group Code");
            $("#gname").text("Sub Group Name");
            $("#divcode").css("display", "block");
            $("#divname").css("display", "block");
            $("#divpcode").css("display", "block");
            $("#divpname").css("display", "block");
            $("#gcode").text("Sub Group Code");
            $("#gname").text("Sub Group Name");
            $("#btnsubmit").css("display", "block");
            $("#btncancel").css("display", "block");
        }
    });
    $(document).ready(function () {
        $("#root").click(function (e) {

            $("#Code").css("float", "left");
            $("#Code").css("width", "100%");
            $("#parentname").css("display", "none");
            $("#Name").css("float", "left");
            $("#Name").css("width", "100%");
            $("#gcode").text("Group Code");
            $("#gcode").text("Group Name");
            $("#divpcode").css("display", "none");
            $("#divpname").css("display", "none");
            $("#divcode").css("display", "block");
            $("#divname").css("display", "block");
            $("#gcode").text("Group Code");
            $("#gname").text("Group Name");
            $("#ParentGroupId").val(0);
            $("#btnsubmit").css("display", "block");
            $("#btncancel").css("display", "block");
            $(function () {
                $("#divtree").jstree();
            });
        });
        //        $("#parentname").css("display", "none");

        //        $("#Code").attr("maxlength", 50);
        $(".usr").click(function (e) {

            $.get("/Group/GetParentgroupEdit", { id: this.id }, function (data) {

                if (data != null) {

                    $("#ParentGroupId").val(data.ParentGroupId);
                    $("#Id").val(data.Id);
                    $("#Code").val(data.Code);
                    $("#Name").val(data.Name);
                    $("#CompanyId").val(data.CompanyId);
                    $("#UserId").val(data.UserId);
                    $("#BranchId").val(data.BranchId);
                    $("#CreatedBy").val(data.CreatedBy);
                    $("#CreatedOn").val(data.CreatedOn);
                    $("#divcode").css("display", "block");
                    $("#divname").css("display", "block");
                    $("#divpcode").css("display", "block");
                    $("#divpname").css("display", "block");
                    if (data.ParentGroupId > 0) {
                        $("#gcode").text("Sub Group Code");
                        $("#gname").text("Sub Group Name");
                    }
                    else {
                        $("#gcode").text("Group Code");
                        $("#gname").text("Group Name");
                    }
                    $("#btnsubmit").css("display", "block");
                    $("#btncancel").css("display", "block");
                }


            });
        });
    });
</script>
<script type="text/javascript">
    $(document).ready(function () {


        $("#btncancel").on("click", function () {


            location.href = "/Group/Create";


        });

        $("#btnEdit").on("click", function () {


            location.href = "/Group/Create";


        });

    });
</script>



@using (Html.BeginForm(new { @role = "form" }))
{
   @Html.ValidationSummary(true)
    @Html.HiddenFor(d => d.Id)
     @Html.HiddenFor(d => d.ParentGroupId)
       @Html.HiddenFor(d => d.CompanyId)
         @Html.HiddenFor(d => d.UserId)
           @Html.HiddenFor(d => d.BranchId)
             @Html.HiddenFor(d => d.CreatedBy)
               @Html.HiddenFor(d => d.CreatedOn)

    <aside class="right-side">
<!-- Content Header (Page header) -->
<section class="content-header">
                    <h1>
                        Product Group
                        <small>Master</small>
                    </h1>
                    <ol class="breadcrumb">
                        <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
                        <li><a href="#">Forms</a></li>
                        <li class="active">Product Group</li>
                    </ol>
                </section>
                 <div class="nav-tabs-custom">
                                <ul class="nav nav-tabs">
                                   
                                    <li class="pull-right"><input type="submit" id="btnsubmit" class="btn btn-primary" value="Save" />
                                      <li class="pull-right"><input type="button" id="btnEdit" class="btn btn-primary" value="Go to Create Page" /></li>
                                    
                                   @if (ViewBag.count == 0)
                                   {
                                       <input type="button" id="btncancel" class="btn btn-primary" value="Cancel" />
                                   }

                                  
                                    
                                    </li>
                                </ul>
                         
              </div>    
<!-- Main content -->
<section class="content">
                    <div class="row">
                        <!-- left column -->
                        <div class="col-md-6">
                            <!-- general form elements -->
                            <div class="box box-primary">
                                <div class="box-header">
                                    <h3 class="box-title">Edit Group OR Sub Group</h3>
                                </div><!-- /.box-header -->
                                <!-- form start -->
                             
                                    <div class="box-body">


       @if (ViewBag.Message != null)
       {
                  <div class="alert alert-success alert-dismissable">
                                    <i class="fa fa-check"></i>
                                    <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
                                  @ViewBag.Message 
                     </div>
               
           
       }
       

       

       @if (ViewBag.Error != null)
       {
                 <div class="alert alert-danger alert-dismissable">
         <i class="fa fa-ban"></i>
        <button class="close" aria-hidden="true" data-dismiss="alert" type="button">×</button>
<b>Error!</b>
@ViewBag.Error </div>
           
       }


     
<br />

<b>Please Select A Group Or Subgroup From The Tree Below To Edit</b>
<br />
&nbsp;&nbsp;&nbsp;&nbsp;
<br />
 <div class="clr"></div>
 <div id="divtree">

@if (ViewBag.President != null)
{
    foreach (XenERP.Models.Group item in ViewBag.President)
    {
<ul id="tree" >
 <li>
   <a href="#" id='@item.Id' class="usr">@item.Code</a>
    @Html.Partial("Childrens", item)
 </li>
</ul>
    }
}
</div>
<br />


                                      
                                
                                   

                                    <div class="clr"></div>
                                        <div class="form-group" id="divcode">
                                            <label for="code" id="gcode">Group Code:</label>
                                             <div class="clr"></div>
                                             
                                  
                                       
                                         @Html.TextBoxFor(model => model.Code, new { @class = "form-control", @placeholder = "Enter Code" })
                                        
                                 
                                       
                                         <span style='color:red;margin-right:65%; display:inline-block;'>&nbsp;</span>
                              @Html.ValidationMessageFor(model => model.Code)  
                                        </div>
                                           <div class="clr"></div>
                                        <div class="form-group" id="divname">
                                            <label for="name" id="gname">Group Name:</label>
                                          <div class="clr"></div>
                                             
                                  
                                     
                                       
                                         @Html.TextBoxFor(model => model.Name, new { @class = "form-control", @placeholder = "Enter  Name" })
                                          <span style='color:red;margin-right:65%; display:inline-block;'>&nbsp;</span>
                                 @Html.ValidationMessageFor(model => model.Name) 
                                       
                               
                                        </div>
                                      
                                       
                                    </div><!-- /.box-body -->
                                    <div id="loading">
                                    <div id="loadingcontent">
                                         <p id="loadingspinner">
                                          Loading...
                                      </p>
                                     </div>
                                    </div>
                                   
                            </div><!-- /.box -->

                            

                        </div><!--/.col (left) -->
                       
                    </div>   <!-- /.row -->
                     
                </section>
<!-- /.content -->
</aside>
}


<script type="text/javascript">
    $(function () {
        $("#divtree").jstree();
    });
</script>