@model XenERP.Models.LotTrack

@{
    /**/

    Layout = "~/Views/Shared/_Layout.cshtml";
}

<link href="~/css/datetimepicker/datepicker.css" rel="stylesheet" />
<script type="text/javascript" src="~/Scripts/JqueryValidation.js"></script>
<script src="../../js/plugins/datetimepicker/bootstrap-datepicker.js" type="text/javascript"></script>
<script src="../../js/jquery-ui-1.10.3.js" type="text/javascript"></script>
<link href="~/Content/select2/select2.min.css" rel="stylesheet" />
<script src="~/Content/select2/select2.full.min.js"></script>

<style>
    .table-responsive {
        min-height: 0.01%;
        overflow-x: auto;
    }

    /*.select2 {
        width: 200px;
    }*/

    .input_width {
        width: 100%;
    }

    table.chompa td input[type="text"] {
        width: 100%;
    }

    table.chompa td select {
        width: 100%;
    }

    .txtWdt{
        width:100px;
    }

    .txtWdt1 {
        width: 200px;
    }
</style>

<script src="~/Scripts/JqueryValidation.js" type="text/javascript"></script>

<script type="text/javascript">
    $(document).ready(function () {
        $(".select2").select2();
        $("#dp3").datepicker({ autoclose: true, todayHighlight: true });
     
        $(".plcDt").datepicker({ autoclose: true, todayHighlight: true, format: 'dd/mm/yyyy' });
    });
</script>

<script>
    $(document).ready(function () {
        //$("#LotNo,#NumberOfBook").keydown(function (e) {
        $("#expnse_Tab").on('keydown', '.onlNo', function () {
            // Allow: backspace, delete, tab, escape, enter and .
            if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 110, 190]) !== -1 ||
                // Allow: Ctrl+A, Command+A
                (e.keyCode == 65 && (e.ctrlKey === true || e.metaKey === true)) ||
                // Allow: home, end, left, right, down, up
                (e.keyCode >= 35 && e.keyCode <= 40)) {
                // let it happen, don't do anything
                return;
            }
            // Ensure that it is a number and stop the keypress
            if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
                e.preventDefault();
            }
        });


    });

</script>

<script type="text/javascript">
    $(document).ready(function () {
        $("form").on("submit", function (event) {

            return confirm("একবার সাবমিট করে দিলে পুনরায় কোনো এডিট করা যাবে না,সুতরাং চেক করে সাবমিট করুন");
        });
    });

</script>

<script>
    $(document).ready(function () { captureImageClicks(); });

    function captureImageClicks() {
        $(document).on("click", "img[id^='img']", function (e) {

            var tableId = $(this).closest('table').attr('id');
            var tr = $(this).closest('tr');

            if (tableId == "expnse_Tab") {
                this.id == "imgtransferredAssesseeAdd" ? addGridRow(tr) : deleteRow(tr);
            }
        });
        //  addTransferredAssesseeGridValidations($("#imgtransferredAssesseeAdd").closest("tr"));

    }                                                   //clone the exist & transfer assessee
    function addGridRow(tr) {

        var clone;
        tr.after(function () {
            clone = tr.clone();
            clone.find('input').val("").end();
            clone.find('select').empty().end();
            return clone;
        });
        changeNameID(clone, 1);
        var index = $("#expnse_Tab").find("tr").length - 2;
        $("#LotTrackEntryDetailsList_" + index + "__PlacementDate").datepicker({ autoclose: true, todayHighlight: true, format: 'dd/mm/yyyy' });
        tr.find("img[id^='img']").hide();
        return clone;
    }
    function deleteRow(tr) {
        var table = tr.closest("table");
        var maxtr = $(table).find('tbody tr');
        if (checkMinRows(tr) == false) {
            alertBox("You cannot  have less than " + maxtr.length + "  Row for this table");
            return;
        }
        changeNameID(tr, -1);
        tr.prev().find("img[id^='img']").show();
        tr.remove();
    }
    function changeNameID(tr, num) {
        var index = $("#expnse_Tab").find("tr").length - 2;

        tr.find(".ind").val(index);

        tr.find('input,select').attr("id", function () { return this.id.replace(/LotTrackEntryDetailsList_(\d+)/, function (n) { return "LotTrackEntryDetailsList_" + index }) });
        tr.find('input,select').attr("name", function () { return this.name.replace(/LotTrackEntryDetailsList\[(\d+)/, function (n) { return "LotTrackEntryDetailsList\[" + index }) });
    }

    function checkMinRows(tr) {
        var numRows = tr.closest("tbody")[0].rows.length;
        if (numRows == 1) return false;
        return true;
    }


</script>


@using (Html.BeginForm("CreateLotTracking", "HariDailyEntry", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
    <aside class="right-side">

        <section class="content-header" style="text-align:center">
            <h4><b>Lot Tracking</b> </h4>
            <ol class="breadcrumb">
                <li><a href="#"><i class="fa fa-dashboard"></i>Home</a></li>
                <li><a href="#">Forms</a></li>
                <li class="active">Farm Create</li>
            </ol>
        </section>

        <!-- Main content -->

        <div class="col-md-12">

            <div class="col-md-6">
                <div class="box box-primary">
                    <div class="box-header">  </div>
                    <div class="box-body">
                        <div class="form-group">
                            <label class=""> HO Sending Date:<span style="color:Red;">*</span> </label>
                            <div class="input-group date" id="dp3" data-date-format="@Session["DateFormatLower"]">@Html.TextBoxFor(model => model.SendDate, new { @class = "form-control", @readonly = "" })  <span class="input-group-addon" style=" width:auto !important"><i class="glyphicon glyphicon-calendar"></i></span> </div>
                            @Html.ValidationMessageFor(model => model.SendDate)
                            @Html.HiddenFor(model => model.Id)
                        </div>
                    </div>

                </div>

            </div>


            <div class="col-xs-12">
                <div class="box">
                    <div class="box-body table-responsive no-padding">
                        <table id="expnse_Tab" class="table table-bordered table-striped">
                            <thead>
                                <tr>
                                    <th>Lot No</th>
                                    <th>Placement date</th>
                                    <th> No Of Books</th>
                                    <th>Pending Books</th>
                                    <th>Remarks</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                @if (Model.LotTrackEntryDetailsList != null)
                                {
                                    for (int i = 0; i < Model.LotTrackEntryDetailsList.Count(); i++)
                                    {
                                        <tr>

                                            <td class="txtWdt">
                                                @Html.TextBoxFor(modelItem => Model.LotTrackEntryDetailsList[i].LotNo, new { @class = "form-control onlNo" })
                                                @Html.HiddenFor(m => m.LotTrackEntryDetailsList[i].IndexNo, new { @class = "ind" })
                                                @Html.ValidationMessageFor(m=>m.LotTrackEntryDetailsList[i].LotNo)
                                            </td>

                                            <td class="txtWdt1">
                                                <div class="input-group date" id="dp4" data-date-format="@Session["DateFormatLower"]">  @Html.TextBoxFor(modelItem => Model.LotTrackEntryDetailsList[i].PlacementDate, new { @class = "form-control plcDt", @readonly = "readonly" })<span class="input-group-addon" style=" width:auto !important"><i class="glyphicon glyphicon-calendar"></i></span> </div>
                                                @Html.ValidationMessageFor(m => m.LotTrackEntryDetailsList[i].PlacementDate)
                                            </td>
                                            <td class="txtWdt">
                                                @Html.TextBoxFor(modelItem => Model.LotTrackEntryDetailsList[i].NumberOfBook, new { @class = "form-control onlNo" })
                                                @Html.ValidationMessageFor(m => m.LotTrackEntryDetailsList[i].NumberOfBook)
                                            </td>
                                            <td class="txtWdt">
                                                @Html.TextBoxFor(modelItem => Model.LotTrackEntryDetailsList[i].PendingBook, new { @class = "form-control onlNo" })
                                              
                                            </td>
                                            <td>
                                                @Html.TextBoxFor(modelItem => Model.LotTrackEntryDetailsList[i].Remarks, new { @class = "form-control" })

                                            </td>

                                            <td>
                                                <img src="~/Images/icon-add.png" id="imgtransferredAssesseeAdd" class="HandCursor" />
                                                <img src="~/Images/icon-delete.png" id="imgtransferredAssesseeDel" class="HandCursor" />
                                            </td>
                                        </tr>
                                    }
                                }
                            </tbody>

                        </table>
                    </div>

                    <div class="col-md-6">
                        <div class="form-group">
                            <li style="list-style-type:none;margin-top:20px;">
                                <div class="col-md-2"></div>
                                <div class="col-md-2 pull-right">
                                    <input name="" type="submit" id="btnsave" value="Save" class="btn btn-success" />
                                </div>
                                <div class=" col-md-2 pull-right">
                                    <a href="@Url.Action("LotTrackingList", "HariDailyEntry")">
                                        <input name="" type="button" value="Back" class="btn btn-info" />
                                    </a>

                                </div>

                            </li>
                        </div>
                    </div>

                </div>

            </div>


        </div>

    </aside>
}

