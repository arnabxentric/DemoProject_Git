@model XenERP.Models.FcrMasterModelView

using XenERP.Models
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@{

    int Slno = 0;
}
<link href="../../css/AdminLTE.css" rel="stylesheet" type="text/css" />
<link href="../../css/Designer.css" rel="stylesheet" type="text/css" />
<link href="~/css/datetimepicker/datepicker.css" rel="stylesheet" />
<script type="text/javascript" src="~/Scripts/JqueryValidation.js"></script>
<script src="../../js/plugins/datetimepicker/bootstrap-datepicker.js" type="text/javascript"></script>
<style type="text/css">
    table.dataTable thead .sorting_desc {
        background: url("/Images/sort_desc.png") no-repeat scroll right center #53A9BC;
    }

    table.dataTable thead .sorting_asc {
        background: url("/Images/sort_asc.png") no-repeat scroll right center #53A9BC;
    }
</style>

<style>
    .example-modal .modal {
        position: relative;
        top: auto;
        bottom: auto;
        right: auto;
        left: auto;
        display: block;
        z-index: 1;
    }

    .modal {
        position: fixed;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        z-index: 1040;
        display: none;
        overflow: auto;
        overflow-y: scroll;
    }

    .modal-content {
        background-color: #ffffff;
        width: 330px;
        margin: 130px auto 0 auto;
        text-align: center;
    }

    .example-modal .modal {
        background: transparent !important;
    }
</style>

<script type="text/javascript">

    $(function () {
        $('#example1').dataTable({
            "bPaginate": true,
            "bLengthChange": true,
            "bFilter": true,
            "bSort": false,
            "bInfo": true,
            "bAutoWidth": true,
            "fnRowCallback": function (nRow, aData, iDisplayIndex, iDisplayIndexFull) {

                if (aData[6] == "Already Received") {
                    $('td', nRow).css('border-color', 'Red');
                }
                else {
                    $('td', nRow).css('border-color', 'Green');
                }
            }
        });
    });
</script>

<script>
    $(document).ready(function () {
        $("#dp3").datepicker({ autoclose: true, todayHighlight: true });
        $("#dp4").datepicker({ autoclose: true, todayHighlight: true });

        $("#example").on('keyup', '.intk', function () {
            var comptd = $(this).closest('td');
            var comptr = comptd.closest('tr');
            var weight = parseFloat(comptr.find('.wgt').val()) || 0;
            var preIntk = comptr.prev();
            var preCons = parseFloat(preIntk.find('.cumcon').val() || 0);

            var cumulative = parseFloat(preCons) + parseFloat($(this).val());
            var fcr = parseFloat((cumulative / weight)).toFixed(2) || 0;
            comptr.find('.cumcon').val(cumulative);
            comptr.find('.fcr').val(fcr);
        });

        $("#example").on('keyup', '.wgt', function () {
            var comptd = $(this).closest('td');
            var comptr = comptd.closest('tr');
            var cumulative = (parseFloat(comptr.find('.cumcon').val())) || 0;
            var fcr = (parseFloat((cumulative / ($(this).val() || 0))).toFixed(2)) || 0;
            comptr.find('.fcr').val(fcr);
        });

        //$("form").on("submit", function (event) {
        //    $('.wgt').each(function () {
        //        var x = this.val();
        //        alert(x);
        //        if (parseFloat(this.val()) == '') {
        //            alert(this.val());
        //            $(this).css({ 'background-color': 'red' });
        //            return false;
        //        }
        //    });
        //});

    });
</script>
@using (Html.BeginForm("FcrIndex", "HariFcrMaster", FormMethod.Post))
{

    <aside class="right-side">
        <section class="content-header">
            <h1>Daily Feed Consumption Chart <small>List</small> </h1>
            <ol class="breadcrumb">
                <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
                <li><a href="#">Forms</a></li>
                <li class="active">General Elements</li>
            </ol>
        </section>



        @if (ViewBag.Message != null)
        {
            <div class="alert alert-success alert-dismissable">
                <i class="fa fa-check"></i>
                <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
                @ViewBag.Message
            </div>
        }

        @if (ViewBag.Error != null)
        {
            <div class="alert alert-danger alert-dismissable">
                <i class="fa fa-ban"></i>
                <button class="close" aria-hidden="true" data-dismiss="alert" type="button">×</button>
                <b>Error!</b>
                @ViewBag.Error
            </div>
        }





        <div class="box">

            <div class="box-body table-responsive">
                <div class="col-xs-12" style="text-align:center">
                    <input name="" type="submit" id="btnsave" value="Submit" class="btn btn-primary" />
                </div>

                <table id="example" class="table table-bordered table-striped">
                    <thead>
                        <tr>
                            <th>Age (In Days)</th>
                            <th>Feed Intake (For 1 Bird)</th>
                            <th>Cumulative Feed Consumption</th>
                            <th>Weight Gain (In Gram)</th>
                            <th>FCR</th>

                        </tr>
                    </thead>

                    <tbody>

                        @for (int i = 0; i < Model.fcrList.Count(); i++)
                        {
                        <tr>
                            <td>
                                @Html.TextBoxFor(m => Model.fcrList[i].AGE, new { @class = "form-control age", @readonly = "readonly" })
                                @*@Html.HiddenFor(m => Model.fcrList[i].AGE, new { @class = "id" })*@
                            </td>

                            <td>@Html.TextBoxFor(m => Model.fcrList[i].FEEDINTAKE, new { @class = "form-control intk" })</td>

                            <td>@Html.TextBoxFor(m => Model.fcrList[i].CUMULATIVEFEEDCONSUMPTION, new { @class = "form-control cumcon", @readonly = "readonly" })</td>

                            <td>@Html.TextBoxFor(m => Model.fcrList[i].WEIGHTGAIN, new { @class = "form-control wgt" })</td>

                            <td>@Html.TextBoxFor(m => Model.fcrList[i].FCR, new { @class = "form-control fcr", @readonly = "readonly" })</td>

                        </tr>
                        }


                    </tbody>
                </table>
            </div><!-- /.box-body -->
        </div>


    
    </aside>

}