@{
    ViewBag.Title = "ExportExcel";
}


@model XenERP.Models.ModelView.FeedStockModelView
@{
    // Layout = "~/Views/Shared/_Layout.cshtml";
    Layout = "~/Views/Shared/_LayoutReport.cshtml";
    int slNo = 0;

}

<html>
<head>
    <title>District List</title>
    <style>
        .example-modal .modal {
            position: relative;
            top: auto;
            bottom: auto;
            right: auto;
            left: auto;
            display: block;
            z-index: 1;
        }

        .modal-content {
            background-color: #b2b266;
            width: 330px;
            margin: 130px auto 0 auto;
            text-align: center;
        }

        .example-modal .modal {
            background: transparent !important;
        }
    </style>
    <link href="~/Content/vendors/datatables.net-bs/css/dataTables.bootstrap.min.css" rel="stylesheet" />
    <link href="~/Content/vendors/datatables.net-buttons-bs/css/buttons.bootstrap.min.css" rel="stylesheet" />
    <link href="~/Content/vendors/datatables.net-fixedheader-bs/css/fixedHeader.bootstrap.min.css" rel="stylesheet" />
    <link href="~/Content/vendors/datatables.net-responsive-bs/css/responsive.bootstrap.min.css" rel="stylesheet" />
    <link href="~/Content/vendors/datatables.net-scroller-bs/css/scroller.bootstrap.min.css" rel="stylesheet" />
    <script src="~/Content/vendors/datatables.net/js/jquery.dataTables.min.js"></script>
    <script src="~/Content/vendors/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
    <script src="~/Content/vendors/datatables.net-buttons/js/dataTables.buttons.min.js"></script>
    <script src="~/Content/vendors/datatables.net-buttons-bs/js/buttons.bootstrap.min.js"></script>
    <script src="~/Content/vendors/datatables.net-buttons/js/buttons.flash.min.js"></script>
    <script src="~/Content/vendors/datatables.net-buttons/js/buttons.html5.min.js"></script>
    <script src="~/Content/vendors/datatables.net-buttons/js/buttons.print.min.js"></script>
    <script src="~/Content/vendors/datatables.net-fixedheader/js/dataTables.fixedHeader.min.js"></script>
    <script src="~/Content/vendors/datatables.net-keytable/js/dataTables.keyTable.min.js"></script>
    <script src="~/Content/vendors/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
    <script src="~/Content/vendors/datatables.net-responsive-bs/js/responsive.bootstrap.js"></script>
    <script src="~/Content/vendors/datatables.net-scroller/js/dataTables.scroller.min.js"></script>
    <script src="~/Content/vendors/jszip/dist/jszip.min.js"></script>
    <script src="~/Content/vendors/pdfmake/build/pdfmake.min.js"></script>
    <script src="~/Content/vendors/pdfmake/build/vfs_fonts.js"></script>


    <script type="text/javascript">
        //$(document).ready(function () {
        //    $('#example2').DataTable({
        //        "paging": true,
        //        "lengthChange": true,
        //        "searching": true,
        //        "ordering": true,
        //        "info": true,
        //        "autoWidth": false
        //    });
        //});

    </script>
    <script>
        $(document).ready(function () {
            $("#btnsubmit").on("click", function () {
                var bankId = $("#BankId").val();
                var neftId = $("#NeftId").val();

                if (bankId != '') {
                    $.get("/FarmerReport/ChangeBankId", { id: neftId, BankId: bankId }, function (data) {
                        alert("Bank Changed Successful");

                    });
                }
                else {
                    $("#OpeningBalance").val('0.0');
                }
            });
        });
    </script>


    <script>

        $(document).ready(function () {

            var handleDataTableButtons = function () {
                if ($("#example2").length) {

                    $("#example2").DataTable({
                        //"fnRowCallback": function (nRow, aData, iDisplayIndex, iDisplayIndexFull) {
                        //    if (aData[4] != "") {
                        //        $('td', nRow).css('background-color', 'IndianRed');
                        //    }
                        //},
                        dom: "Bfrtip",
                        buttons: [

                          {
                              extend: "copy",
                              className: "btn-sm"
                          },

                          //{
                          //    extend: "excelHtml5",
                          //    className: "btn-sm",
                          //    title: "NEFT Sheet",
                          //    //exportOptions: {
                          //    //    columns: [0, 1, 2, 3, 4, 5, 6, 7, 8]
                          //    //},
                          //    customize: function (xlsx) {
                          //        var sheet = xlsx.xl.worksheets['sheet1.xml'];
                          //        $('row c[r^="C"]', sheet).attr('s', '2');
                          //        var col = $('col', sheet);
                          //        $(col[11]).attr('width', 50);
                          //    },

                          //},

                                 {
                                     extend: "pdfHtml5",
                                     className: "btn-sm",
                                     title: "NEFT Sheet",
                                     orientation: 'landscape',
                                     pageSize: 'LEGAL',
                                     //exportOptions: {
                                     //    columns: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
                                     //},
                                     // message: "Date From : " + fd + " " + "Date To: " + td + " " + "Right Holder: " + rh + " " + "Rifgt Violation: " + rv + " " + "Activity: " + act + " " + "Status: " + sts + " " + "Block: " + blk

                                 },


                        ],
                        responsive: true
                    });
                }
            };

            TableManageButtons = function () {
                "use strict";
                return {
                    init: function () {
                        handleDataTableButtons();
                    }
                };
            }();

            $('#datatable').dataTable();

            $('#datatable-keytable').DataTable({
                keys: true
            });

            $('#datatable-responsive').DataTable();

            $('#datatable-scroller').DataTable({
                ajax: "js/datatables/json/scroller-demo.json",
                deferRender: true,
                scrollY: 380,
                scrollCollapse: true,
                scroller: true
            });

            $('#datatable-fixed-header').DataTable({
                fixedHeader: true
            });

            var $datatable = $('#datatable-checkbox');

            $datatable.dataTable({
                'order': [[1, 'asc']],
                'columnDefs': [
                  { orderable: false, targets: [0] }
                ]
            });
            $datatable.on('draw.dt', function () {
                $('input').iCheck({
                    checkboxClass: 'icheckbox_flat-green'
                });
            });

            TableManageButtons.init();


        });
    </script>
</head>



<body>
    <aside class="right-side">
        <section class="content-header">
            <h1>
                NEFT Sheet<small>List</small>


            </h1>
            <ol class="breadcrumb">
                <div class="col-xs-12"><a href="@Url.Action("NEFT_Export", "FarmerReport", new { id=Model.UnitId})" class="btn btn-primary"> <i class="fa fa-fw fa-plus-square"></i>EXCEL EXPORT</a></div>

            </ol>
        </section>

        <div class="row">

            <!-- Main content -->
            <!-- left column -->
            <div class="col-md-6">
                <!-- general form elements -->
                <div class="box box-primary">
                    <div class="box-header">

                    </div>
                    <!-- form start -->

                    <div class="box-body">
                        <div class="form-group">
                            <label class="black_txt_010">
                                Bank Name :<span style="color:Red;">*</span>
                            </label>
                            @Html.DropDownListFor(model => model.BankId, new SelectList(ViewBag.bank, "Value", "Text"), "-----Select a Bank----", new { @class = "form-control" })
                            @*@Html.ValidationMessageFor(model => model.BankId)*@
                            @Html.HiddenFor(m => m.NeftId)

                        </div>
                    </div>
                    <div><li class="pull-right"><input type="button" id="btnsubmit" class="btn btn-primary" value="Update Bank" /></div>


                </div>
            </div>
        </div>


        <div class="box">

            <div class="box-body table-responsive">
                <table id="example2" class="table table-bordered table-hover">
                    <thead>
                        <tr>
                            <th>Sr.No.</th>
                            @*<th>TRAN.ID</th>*@
                            <th>AMOUNT</th>
                            @*<th>SENDER ACCOUNT TYPE</th>*@
                            <th>SENDER ACCOUNT NO</th>
                            @*<th>SENDER NAME</th>*@
                            @*<th>SMS EML</th>
                            <th>Detail</th>*@
                            @*<th>OoR7002 (SENDER NAME)</th>*@
                            <th>BENEFICIARY IFSC</th>
                            @*<th>BENEFICIARY ACCOUNT TYPE</th>*@
                            <th>BENEFICIARY ACCOUNT NO</th>
                            <th>BENEFICIARY ACCOUNT NAME</th>
                            @*<th>SENDER TO RECEIVER INFORMATION</th>*@
                        </tr>
                    </thead>
                    <tbody>


                        @foreach (var item in Model.neftList)
                        {
                            slNo = slNo + 1;
                            <tr>
                                <td>
                                    @slNo
                                </td>
                                @*<td></td>*@

                                <td>
                                    @Html.DisplayFor(m => item.GCAmount)
                                </td>
                                @*<td>@Html.DisplayFor(m => item.Senactype)</td>*@
                                <td>@Html.DisplayFor(m => item.Senaccno)</td>
                                @*<td>@Html.DisplayFor(m => item.SenName)</td>*@
                                @*<td>@Html.DisplayFor(m => item.SMSEML)</td>*@
                                @*<td>@Html.DisplayFor(m => item.SenMobileNo)</td>*@
                                @*<td>@Html.DisplayFor(m => item.SenName)</td>*@
                                <td>@Html.DisplayFor(m => item.IfscCode)</td>
                                @*<td>@Html.DisplayFor(m => item.BenAcType)</td>*@
                                <td>@Html.DisplayFor(m => item.BenAcNo)</td>
                                <td>@Html.DisplayFor(m => item.BankAcHolderNm)</td>
                                @*<td>Urgent</td>*@
                            </tr>

                        }

                    </tbody>

                </table>
            </div>
        </div>
    </aside>



</body>

</html>
